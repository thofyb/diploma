\label{sec:relatedworks}


\subsection{Аналогичные исследования}


Для поиска аналогичных исследований, связанных с энергетическими запахами кода Android, использовался сервис “Google Scholar” с поисковыми запросами по ключевым словам: \texttt{android}, \texttt{energy code smell}, \texttt{energy anti-patterns}, \texttt{refactoring}. Из полученных результатов были отобраны работы, темы которых были схожи с исследованием запахов кода или разработкой инструмента для обнаружения или исправления запахов кода. На втором этапе были изучены другие работы авторов отобранных статей, а также работы, в которых отобранные на первом шаге статьи цитировались. Таким образом был найден список отобранных статей, посвященных энергоэффективной Android разработке, среди которых были найдены новые статьи, связанные с темой данной работы. Также в процессе поиска была найдена работа, текст которой отсутствовал в открытом доступе, поэтому мы связались с одним из авторов, и он выслал текст статьи.

Gottschalk et al. \cite{gottschalk2016refactorings} определяют и исследуют такие запахи кода, как \emph{Data Transfer}, \emph{Backlight}, \emph{Statement Change}, \emph{Third-Party Advertising}, \emph{Binding Resources Too Early}. Для выявления этих запахов авторы использовали графовое представление исходного кода и взаимодействовали с этим графом с помощью библиотеки JGraLab\footnote{http://jgralab.github.io/}. В результате работы было выявлено, что все исследуемые запахи кода негативно влияют на энергопотребление приложения. Также исследователи составили список теоретически энергозатратных запахов кода для изучения в будущих работах.

Cruz et al. \cite{cruz2017performance} исследовали влияние на энергопотребление наиболее часто встречаемых ошибок, которые распознает Android Lint\footnote{http://tools.android.com/tips/lint}: \emph{Draw Allocation}, \emph{WakeLock}, \emph{Recycle}, \emph{Obsolete Layout Param}, \emph{View Holder}, \emph{Over\-draw}, \emph{Unused Resources}, \emph{Useless Parent}. Авторы измеряли влияние этих запахов на энергопотребление и пришли к выводу, что исправление запахов кода \emph{Draw Allocation}, \emph{WakeLock}, \emph{Recycle}, \emph{Obsolete Layout Param} и \emph{View Holder} положительно влияет на энергозатраты приложения. 


Reimann et al. \cite{reimann2014tool} представили каталог\footnote{https://martinbrylski.github.io/android\_smells/} специфических для Android антипаттернов с предложениями по их исправлению. Среди этих антипаттернов исследователи выделили паттерны, теоретически влияющих на энергопотребление. Данный каталог основан на работах Фаулера и Брауна с учетом особенности Android разработки. 

Carette et al. \cite{carette2017investigating} исследовали антипаттерны, выбранные на основе результатов своих предыдущих работ и советов по разработке в официальной документации Android: \emph{HashMap Usage}, \emph{Internal Getter/Setter} и \emph{Member Ignoring Method}. В этой работе исследователи представили инструмент для автоматического рефакторинга HOT-PEPPER, поддерживающего исследуемые запахи кода. В результате работы было выявлено, что исправление каждого запаха кода положительно влияет на энергопотребление приложений.

Palomba et al. \cite{palomba2019impact} исследовали 9 запахов кода, выбранных из каталога Рейманна: \emph{Data Transmission Without Compression}, \emph{Durable Wakelock}, \emph{Inefficient Data Structure}, \emph{Inefficient SQL Query}, \emph{Inefficient Data Format And Parser}, \emph{Internal Setter}, \emph{Leaking Thread}, \emph{Member Ignoring Method и Slow Loop}. Для поиска этих антипаттернов их предыдущая разработка aDoctor \cite{palomba2017lightweight}. В результате проведенных экспериментов антипаттерны \emph{Internal Setter}, \emph{Leaking Thread}, \emph{Member Ignoring Method} и \emph{Slow Loop} оказались негативно влияющими на энергопотребление.

\begin{table}[]
\begin{tabular}{|l|l|l|l|l|l|}
\hline
\begin{tabular}[c]{@{}l@{}}Подтверждённые\\ антипаттерны\end{tabular}  & \begin{tabular}[c]{@{}l@{}}Gottschalk\\ et al.\end{tabular} & \begin{tabular}[c]{@{}l@{}}Cruz\\ et al.\end{tabular} & \begin{tabular}[c]{@{}l@{}}Carette\\ et al.\end{tabular} & \begin{tabular}[c]{@{}l@{}}Palomba\\ et al.\end{tabular} & \begin{tabular}[c]{@{}l@{}}Morales\\ et al.\end{tabular} \\ \hline
Data Transfer                                                          & \checkmark                                                  &                                                       &                                                          &                                                          &                                                          \\ \hline
Backlight                                                              & \checkmark                                                  &                                                       &                                                          &                                                          &                                                          \\ \hline
Statement Change                                                       & \checkmark                                                  &                                                       &                                                          &                                                          &                                                          \\ \hline
\begin{tabular}[c]{@{}l@{}}Third-Party \\ Advertising\end{tabular}     & \checkmark                                                  &                                                       &                                                          &                                                          &                                                          \\ \hline
\begin{tabular}[c]{@{}l@{}}Binding Resources \\ Too Early\end{tabular} & \checkmark                                                  &                                                       &                                                          &                                                          & \checkmark                                               \\ \hline
DrawAllocation                                                         &                                                             & \checkmark                                            &                                                          &                                                          &                                                          \\ \hline
WakeLock                                                               &                                                             & \checkmark                                            &                                                          &                                                          &                                                          \\ \hline
Recycle                                                                &                                                             & \checkmark                                            &                                                          &                                                          &                                                          \\ \hline
\begin{tabular}[c]{@{}l@{}}Obsolete\\ Layout\\ Param\end{tabular}      &                                                             & \checkmark                                            &                                                          &                                                          &                                                          \\ \hline
View Holder                                                            &                                                             & \checkmark                                            &                                                          &                                                          &                                                          \\ \hline
HashMap Usage                                                          &                                                             &                                                       & \checkmark                                               &                                                          & \checkmark                                               \\ \hline
\begin{tabular}[c]{@{}l@{}}Internal \\ Getter/Setter\end{tabular}      &                                                             &                                                       & \checkmark                                               & \checkmark                                               & \checkmark                                               \\ \hline
\begin{tabular}[c]{@{}l@{}}Member \\ Ignoring \\ Method\end{tabular}   &                                                             &                                                       & \checkmark                                               & \checkmark                                               &                                                          \\ \hline
Leaking Thread                                                         &                                                             &                                                       &                                                          & \checkmark                                               &                                                          \\ \hline
Slow Loop                                                              &                                                             &                                                       &                                                          & \checkmark                                               &                                                          \\ \hline
Blob                                                                   &                                                             &                                                       &                                                          &                                                          & \checkmark                                               \\ \hline
Lazy Class                                                             &                                                             &                                                       &                                                          &                                                          & \checkmark                                               \\ \hline
Refused Bequest                                                        &                                                             &                                                       &                                                          &                                                          & \checkmark                                               \\ \hline
\end{tabular}
\caption{Подтверждённые запахи кода и работы, в которых они исследовались.}
\end{table}

Morales et al. \cite{morales2016anti} изучали запахи кода, полученные на основе работ Фаулера \cite{fowler2018refactoring}, Готтшалк \cite{gottschalk2016refactorings} и советов по разработке в официальной документации Android: \emph{Blob}, \emph{Lazy Class}, \emph{Long-parameter list}, \emph{Refused Bequest}, \emph{Speculative Generality}, \emph{Binding Resources too early}, \emph{HashMap usage} и \emph{Private getters and setters}. Для обнаружения этих антипаттернов исследователи использовали инструмент собственной разработки ReCon \cite{morales2017use}, добавив в него поддержку вышеописанных запахов кода. В качестве тестируемого кода были взято несколько проектов из репозитория FDroid\footnote{https://f-droid.org/}, на которых авторы использовали инструмент и вручную исправляли найденные антипаттерны. В результате экспериментов были выделены энергозатратные антипаттерны: \emph{Blob}, \emph{Lazy Class},  \emph{Refused Bequest}, \emph{Binding Resources too early}, \emph{HashMap usage} и \emph{Private getters and setters}.

Fatima et al. \cite{fatima2020tool} провели исследование и сделали обзор существующих инструментов поддержки Android разработки. Найденные инструменты были разделены на 3 категории: профилировщики, детекторы специфических для Android запахов кода и оптимизаторы. В статье был выделен список антипаттернов, которые покрываются найденными инструментами, а также список используемых для их обнаружения техник и типы входных и выходных данных каждого инструмента (например, исходный код приложения или APK). Наиболее типичной техникой обнаружения был статический анализ кода с использованием предопределённого набора правил и запахов кода. 



\subsection{Инструменты автоматического исправления \\ энергетических запахов кода}
В продолжение к своей предыдущей работе \cite{cruz2017performance} Cruz et al. представили инструмент Leafactor для автоматического рефакторинга выделенных энергетических антипаттернов \cite{cruz2018using}. За основу был взят инструмент AutoRefactor, который является плагином для IDE Eclipse. Авторы добавили в него поддержку автоматического исправления выделенных антипаттернов. В самой работе нет подробностей работы, а также нет ссылки на исходный код инструмента.

HOT-PEPPER -- инструмент, представленный Carette et al. \cite{carette2017investigating}, -- состоит из двух частей. Первая часть основана на инструменте Paprika (программа обнаружения специфических для Android антипаттернов, которая анализирует скомпилированный код приложения и выдаёт список найденных запахов кода). Вторая часть исправляет найденные ошибки в исходном коде программы. Для этого исходный код представляется в виде абстрактного синтаксического дерева, которое изменяется с помощью библиотеки SPOON. 

В \cite{fatima2020detection} Fatima et al. представили собственный инструмент обнаружения и исправления запахов кода 'xAL', основанный на выделенных в предыдущей работе идеях. Новый инструмент является расширением существующего инструмента анализа кода Android Lint. Авторы взяли его за основу, потому что Android Lint имеет интеграцию в официальную среду Android разработки Android Studio, а также имеет API, который позволяет добавлять собственные правила анализа кода. Таким образом исследователи реализовали поддержку 9 новых специфических для Android запахов кода и улучшили поддержку 3 существующих запахов кода.

\begin{table}[]
\begin{tabular}{|l|l|l|l|}
\hline
\begin{tabular}[c]{@{}l@{}}Подтверждённые\\ антипаттерны\end{tabular} & Leafactor  & HOT-PEPPER & xAL        \\ \hline
Data Transfer                                                         &            &            &            \\ \hline
Backlight                                                             &            &            &            \\ \hline
Statement Change                                                      &            &            &            \\ \hline
Third-Party Advertising                                               &            &            &            \\ \hline
Binding Resources Too Early                                           &            &            &            \\ \hline
DrawAllocation                                                        & \checkmark &            &            \\ \hline
WakeLock                                                              & \checkmark &            &            \\ \hline
Recycle                                                               & \checkmark &            &            \\ \hline
Obsolete Layout Param                                                 & \checkmark &            &            \\ \hline
View Holder                                                           & \checkmark &            &            \\ \hline
HashMap Usage                                                         &            & \checkmark &            \\ \hline
Internal Getter/Setter                                                &            & \checkmark &            \\ \hline
Member Ignoring Method                                                &            & \checkmark &            \\ \hline
Leaking Thread                                                        &            &            & \checkmark \\ \hline
Slow Loop                                                             &            &            &            \\ \hline
Blob                                                                  &            &            &            \\ \hline
Lazy Class                                                            &            &            &            \\ \hline
Refused Bequest                                                       &            &            &            \\ \hline
\end{tabular}
\caption{Подтверждённые запахи кода и инструменты, в которых имеется поддержка их автоматического исправления.}
\end{table}


